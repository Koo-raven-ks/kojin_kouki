{% extends "kojin_kouki_kadai/base.html" %}

{% block title %}èª²é¡Œä¸€è¦§{% endblock %}

{% block content %}
<div class="row mb-3 align-items-center">
    <div class="col-md-9">
        <h1>ğŸ“‹ èª²é¡Œä¸€è¦§</h1>
    </div>
    <div class="col-md-3">
        <a href="{% url 'assignment_create' %}" class="btn btn-primary w-100">+ èª²é¡Œã‚’è¿½åŠ </a>
    </div>
</div>

<!-- ãƒ•ã‚£ãƒ«ã‚¿ -->
<div class="card mb-4">
    <div class="card-body">
        <form method="get" class="row g-2">
            <div class="col-md-3">
                <select name="status" class="form-select form-select-sm">
                    <option value="">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</option>
                    {% for value, label in status_choices %}
                    <option value="{{ value }}" {% if request.GET.status==value %}selected{% endif %}>{{ label }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-3">
                <select name="priority" class="form-select form-select-sm">
                    <option value="">å„ªå…ˆåº¦</option>
                    {% for value, label in priority_choices %}
                    <option value="{{ value }}" {% if request.GET.priority==value %}selected{% endif %}>{{ label }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-3">
                <select name="lecture" class="form-select form-select-sm">
                    <option value="">è¬›ç¾©</option>
                    {% for lecture in lectures %}
                    <option value="{{ lecture.id }}" {% if request.GET.lecture==lecture.id|stringformat:"s" %}selected{%
                        endif %}>{{ lecture.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-3">
                <button type="submit" class="btn btn-sm btn-primary w-100">ãƒ•ã‚£ãƒ«ã‚¿</button>
            </div>
        </form>
    </div>
</div>

{% if assignments %}
<div class="card">
    <div class="card-body">
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>èª²é¡Œå</th>
                        <th>è¬›ç¾©</th>
                        <th>å„ªå…ˆåº¦</th>
                        <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                        <th>æœŸé™</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for assignment in assignments %}
                    <tr>
                        <td>{{ assignment.title }}</td>
                        <td>{{ assignment.lecture.name }}</td>
                        <td>
                            {% if assignment.priority == 'high' %}
                            <span class="badge bg-danger">é«˜</span>
                            {% elif assignment.priority == 'medium' %}
                            <span class="badge bg-warning">ä¸­</span>
                            {% else %}
                            <span class="badge bg-secondary">ä½</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if assignment.status == 'pending' %}
                            <span class="badge bg-secondary">æœªæå‡º</span>
                            {% elif assignment.status == 'submitted' %}
                            <span class="badge bg-info">æå‡ºæ¸ˆã¿</span>
                            {% else %}
                            <span class="badge bg-success">æ¡ç‚¹æ¸ˆã¿</span>
                            {% endif %}
                        </td>
                        <td>{{ assignment.due_date|date:"m/d" }}</td>
                        <td>
                            <a href="{% url 'assignment_detail' assignment.pk %}" class="btn btn-sm btn-primary">è©³ç´°</a>
                            <a href="{% url 'assignment_update' assignment.pk %}"
                                class="btn btn-sm btn-secondary">ç·¨é›†</a>
                            <a href="{% url 'assignment_delete' assignment.pk %}" class="btn btn-sm btn-danger">å‰Šé™¤</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ -->
{% if is_paginated %}
<nav aria-label="ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³" class="mt-3">
    <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
        <li class="page-item"><a class="page-link" href="?page=1">æœ€åˆ</a></li>
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">å‰</a></li>
        {% endif %}
        <li class="page-item active"><span class="page-link">{{ page_obj.number }} / {{ page_obj.paginator.num_pages
                }}</span></li>
        {% if page_obj.has_next %}
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">æ¬¡</a></li>
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">æœ€å¾Œ</a></li>
        {% endif %}
    </ul>
</nav>
{% endif %}

{% else %}
<div class="alert alert-info">
    <p>ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ã«åˆã†èª²é¡ŒãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>
</div>
{% endif %}
{% endblock %}